/*! IFrameOrchestrator - v1.3.7 - 2015-05-11
* https://github.com/InstanceOfAnObject/IFrameOrchestrator
* Copyright (c) 2015 ; Licensed  */
!function(){"use strict";var a={},b={},c=function(a,b,c){return a.addEventListener?(a.addEventListener(b,c,!1),!0):a.attachEvent?a.attachEvent("on"+b,c):(b="on"+b,"function"==typeof a[b]&&(c=function(a,b){return function(){a.apply(this,arguments),b.apply(this,arguments)}}(a[b],c)),a[b]=c,!0)},d=function(){var a=1*new Date,b=Math.random(),c=a*b;return a+"."+c},e=function(a){var b={__ifo:!0,__ts:1*new Date,action:a,iframe:{}};parent.postMessage(JSON.stringify(b),"*")},f=function(a){return void 0!==a&&null!==a&&"string"==typeof a},g=function(a){return void 0!==a&&null!==a&&"function"==typeof a},h=function(b,c){if(!f(b))throw new Error("IFrameOrchestratorClient [getProperty] Invalid property name");if(!g(c))throw new Error("IFrameOrchestratorClient [getProperty] ["+b+"] Invalid callback");var h=d(),i={type:"getProperty",uuid:h,data:{key:b}};a[h]=c,e(i)},i=function(a,b){if(!f(a))throw new Error("IFrameOrchestratorClient [setProperty] Invalid property name");var c={type:"setProperty",data:{key:a,value:b}};e(c)},j=function(a,b){if(!f(a))throw new Error("IFrameOrchestratorClient [triggerEvent] Invalid event name");var c={type:"triggerEvent",event:{name:a,data:b}};e(c)},k=function(a,c){if(!f(a))throw new Error("IFrameOrchestratorClient [subscribeEvent] Invalid event name");var d={type:"subscribeEvent",event:{name:a}};b[a]=c,e(d)},l=function(a){if(!f(a))throw new Error("IFrameOrchestratorClient [subscribeEvent] Invalid event name");if(void 0!==b[a]){var c={type:"unsubscribeEvent",event:{name:a}};delete b[a],e(c)}},m={getPropertyReply:function(b){var c=JSON.parse(b.data),d=a[c.uuid];d&&d(c.value),delete a[c.uuid]},eventBroadcast:function(a){var c=JSON.parse(a.data),d=c.name,e=c.data,f=b[d];void 0!==f&&"function"==typeof f&&f(e)}},n=function(a){var b=JSON.parse(a.data),c=b.type;c&&m[c]&&m[c](a)},o=function(){return{getProperty:h,setProperty:i,triggerEvent:j,subscribeEvent:k,unsubscribeEvent:l}};c(window,"message",n),"function"==typeof define&&define.amd?define(function(){return o()}):window.iframeOrchestratorClient=o()}();